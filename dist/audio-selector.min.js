!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("clappr")):"function"==typeof define&&define.amd?define(["clappr"],e):"object"==typeof exports?exports.AudioSelector=e(require("clappr")):t.AudioSelector=e(t.Clappr)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="<%=baseUrl%>/",e(0)}([/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=r(/*! ./src/main.js */1),t.exports=e.default},/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(t,e,r){for(var n=!0;n;){var o=t,i=e,a=r;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;t=l,e=i,r=a,n=!0,s=l=void 0}},u=r(/*! clappr */2),l=r(/*! ./public/level-selector.html */3),c=n(l),d=r(/*! ./public/style.scss */4),f=n(d),h=!1,p=function(t){function e(){o(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),a(e,[{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_READY,this.bindPlaybackEvents),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideContextMenu)}},{key:"unBindEvents",value:function(){this.stopListening(this.core,u.Events.CORE_READY),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVELS_AVAILABLE),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVEL_SWITCH_START),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVEL_SWITCH_END),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_BITRATE)}},{key:"bindPlaybackEvents",value:function(){var t=this.core.getCurrentPlayback();this.listenTo(t,u.Events.PLAYBACK_PLAY,this.onPlay)}},{key:"reload",value:function(){this.unBindEvents(),this.bindEvents(),this.bindPlaybackEvents()}},{key:"shouldRender",value:function(){if(!this.core.getCurrentContainer())return!1;var t=this.core.getCurrentPlayback();if(!t)return!1;var e=t._hls;if(!e)return!1;var r=!!(this.tracks&&this.tracks.length>1);return r}},{key:"render",value:function(){if(this.shouldRender()){var t=u.Styler.getStyleFor(f.default,{baseUrl:this.core.options.baseUrl});this.$el.html(this.template({tracks:this.tracks,title:this.getTitle()})),this.$el.append(t),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.highlightCurrentTrack()}return this}},{key:"onPlay",value:function(){this.fillTracks(),this.render()}},{key:"fillTracks",value:function(){var t=this.core.getCurrentPlayback()._hls;t&&(this.tracks=t.audioTracks,this.setCurrentTrack(t),this.setDefaultTrack())}},{key:"onTrackSelect",value:function(t){var e=this.core.getCurrentPlayback()._hls;if(e)return this.current=parseInt(t.target.dataset.audioSelectorSelect,10),e.audioTrack=this.current,this.toggleContextMenu(),this.highlightCurrentTrack(),t.stopPropagation(),!1}},{key:"onButtonClick",value:function(t){this.toggleContextMenu()}},{key:"hideContextMenu",value:function(){this.$(".audio_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".audio_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".audio_selector button")}},{key:"trackElement",value:function(t){return this.$(".audio_selector ul a"+(isNaN(t)?"":'[data-audio-selector-select="'+t+'"]')).parent()}},{key:"getTitle",value:function(){return(this.core.options.audioSelectorConfig||{}).title}},{key:"updateText",value:function(){if(null!==this.current&&this.tracks[this.current]){var t=this.tracks[this.current].name,e=t.search('"');t=e?t.slice(0,e):t,this.buttonElement().text(t)}}},{key:"highlightCurrentTrack",value:function(){this.trackElement().removeClass("current"),this.current&&this.trackElement(this.current).addClass("current"),this.updateText()}},{key:"setCurrentTrack",value:function(t){h?this.current=t.audioTrack:(this.current=this.getDefaultTrackIndex()||t.audioTrack,h=!0)}},{key:"setDefaultTrack",value:function(){this.core.getCurrentPlayback()._hls.audioTrack=this.current}},{key:"getDefaultTrackIndex",value:function(){for(var t=0,e=0;e<this.tracks.length;e++)if(this.isPositiveDefaultValue(this.tracks[e])){t=e;break}return t}},{key:"getDefaultValueByTrackName",value:function(t){if(!t)return"";var e="default=";if(!t.toLowerCase().includes(e))return"";var r=t.search(e),n=r+e.length;return t.slice(r,n)}},{key:"isPositiveDefaultValue",value:function(t){if(!t)return!1;var e;if("boolean"==typeof t.default&&(e=t.default),"string"==typeof t.default&&(e="yes"===t.default.toLowerCase()),!e){var r=this.getDefaultValueByTrackName(t.name);e="yes"===r.toLowerCase()}return e}},{key:"name",get:function(){return"audio_selector"}},{key:"template",get:function(){return(0,u.template)(c.default)}},{key:"attributes",get:function(){return{class:this.name,"data-audio-selector":""}}},{key:"events",get:function(){return{"click [data-audio-selector-select]":"onTrackSelect","click [data-audio-selector-button]":"onButtonClick"}}}],[{key:"version",get:function(){return VERSION}}]),e}(u.UICorePlugin);e.default=p,t.exports=e.default},/*!******************************************************************************************!*\
  !*** external {"amd":"clappr","commonjs":"clappr","commonjs2":"clappr","root":"Clappr"} ***!
  \******************************************************************************************/
function(e,r){e.exports=t},/*!****************************************!*\
  !*** ./src/public/level-selector.html ***!
  \****************************************/
function(t,e){t.exports='<button data-audio-selector-button></button>\n<ul>\n\n  <% for (var i = 0; i < tracks.length; i++) { %>    \n    <% var track = tracks[i]; %>\n    \n    <% if (track && track.name) { %>  \n      <% var quoteIndex = track.name.search(\'"\'); %>\n      <% var name = quoteIndex ? track.name.slice(0, quoteIndex) : track.name; %>\n      <li>\n        <a href="#" data-audio-selector-select="<%= i %>">\n          <%= name %>\n        </a>\n      </li>  \n    <% }; %>\n    \n  <% }; %>\n\n</ul>\n'},/*!*******************************!*\
  !*** ./src/public/style.scss ***!
  \*******************************/
function(t,e,r){e=t.exports=r(/*! ../../~/css-loader/lib/css-base.js */5)(),e.push([t.id,".audio_selector[data-audio-selector]{float:right;margin-top:5px;position:relative}.audio_selector[data-audio-selector] button{outline:none;background-color:transparent;color:#fff;font-family:Roboto,Open Sans,Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:11px}.audio_selector[data-audio-selector] button:hover{color:#c9c9c9}.audio_selector[data-audio-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.audio_selector[data-audio-selector]>ul{list-style-type:none;position:absolute;bottom:35px;border:1px solid #000;display:none;background-color:rgba(0,0,0,.9)}.audio_selector[data-audio-selector] li{padding:1px;font-size:11px}.audio_selector[data-audio-selector] li[data-title]{background-color:#c3c2c2;padding:5px}.audio_selector[data-audio-selector] li a{color:#666;padding:3px 15px;display:block;text-decoration:none;white-space:nowrap}.audio_selector[data-audio-selector] li a:hover{background-color:#555;color:#fff}.audio_selector[data-audio-selector] li a:hover a{color:#fff;text-decoration:none}.audio_selector[data-audio-selector] li.current a{color:#fff}",""])},/*!**************************************!*\
  !*** ./~/css-loader/lib/css-base.js ***!
  \**************************************/
function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e];r[2]?t.push("@media "+r[2]+"{"+r[1]+"}"):t.push(r[1])}return t.join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}}])});
//# sourceMappingURL=audio-selector.min.js.map
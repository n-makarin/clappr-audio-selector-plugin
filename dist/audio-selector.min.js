!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("clappr")):"function"==typeof define&&define.amd?define(["clappr"],e):"object"==typeof exports?exports.AudioSelector=e(require("clappr")):t.AudioSelector=e(t.Clappr)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="<%=baseUrl%>/",e(0)}([/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=n(/*! ./src/main.js */1),t.exports=e.default},/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var o=t,i=e,a=n;r=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;t=l,e=i,n=a,r=!0,s=l=void 0}},u=n(/*! clappr */2),l=n(/*! ./public/level-selector.html */3),c=r(l),d=n(/*! ./public/style.scss */4),f=r(d),h=function(t){function e(){o(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),a(e,[{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_READY,this.bindPlaybackEvents),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideContextMenu)}},{key:"unBindEvents",value:function(){this.stopListening(this.core,u.Events.CORE_READY),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED),this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVELS_AVAILABLE),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVEL_SWITCH_START),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_LEVEL_SWITCH_END),this.stopListening(this.core.getCurrentPlayback(),u.Events.PLAYBACK_BITRATE)}},{key:"bindPlaybackEvents",value:function(){var t=this.core.getCurrentPlayback();this.listenTo(t,u.Events.PLAYBACK_PLAY,this.onPlay)}},{key:"reload",value:function(){this.unBindEvents(),this.bindEvents(),this.bindPlaybackEvents()}},{key:"shouldRender",value:function(){if(!this.core.getCurrentContainer())return!1;var t=this.core.getCurrentPlayback();if(!t)return!1;var e=t._hls;if(!e)return!1;var n=!!(this.tracks&&this.tracks.length>1);return n}},{key:"render",value:function(){if(this.shouldRender()){var t=u.Styler.getStyleFor(f.default,{baseUrl:this.core.options.baseUrl});this.$el.html(this.template({tracks:this.tracks,title:this.getTitle()})),this.$el.append(t),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.highlightCurrentTrack()}return this}},{key:"onPlay",value:function(){this.fillTracks(),this.render()}},{key:"fillTracks",value:function(){var t=this.core.getCurrentPlayback()._hls;t&&(this.tracks=t.audioTracks,this.setCurrentTrack(),this.setDefaultTrack())}},{key:"onTrackSelect",value:function(t){var e=this.core.getCurrentPlayback()._hls;if(e)return this.current=parseInt(t.target.dataset.audioSelectorSelect,10),e.audioTrack=this.current,this.toggleContextMenu(),this.highlightCurrentTrack(),t.stopPropagation(),!1}},{key:"onButtonClick",value:function(t){this.toggleContextMenu()}},{key:"hideContextMenu",value:function(){this.$(".audio_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".audio_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".audio_selector button")}},{key:"trackElement",value:function(t){return this.$(".audio_selector ul a"+(isNaN(t)?"":'[data-audio-selector-select="'+t+'"]')).parent()}},{key:"getTitle",value:function(){return(this.core.options.audioSelectorConfig||{}).title}},{key:"updateText",value:function(){null!==this.current&&this.tracks[this.current]&&this.buttonElement().text(this.tracks[this.current].name)}},{key:"highlightCurrentTrack",value:function(){this.trackElement().removeClass("current"),this.current&&this.trackElement(this.current).addClass("current"),this.updateText()}},{key:"setCurrentTrack",value:function(){this.current=this.getDefaultTrackIndex()||0}},{key:"setDefaultTrack",value:function(){hls.audioTrack=this.current}},{key:"getDefaultTrackIndex",value:function(){for(var t=0,e=0;e<this.tracks.length;e++)if(this.isPositiveDefaultValue(this.tracks[e])){t=e;break}return t}},{key:"getDefaultValueByTrackName",value:function(t){if(!t)return"";var e="default=";if(!t.toLowerCase().includes(e))return"";var n=t.search(e),r=n+e.length;return t.slice(n,r)}},{key:"isPositiveDefaultValue",value:function(t){if(!t)return!1;var e;if("boolean"==typeof t.default&&(e=t.default),"string"==typeof t.default&&(e="yes"===t.default.toLowerCase()),!e){var n=this.getDefaultValueByTrackName(t.name);e="yes"===n.toLowerCase()}return e}},{key:"name",get:function(){return"audio_selector"}},{key:"template",get:function(){return(0,u.template)(c.default)}},{key:"attributes",get:function(){return{class:this.name,"data-audio-selector":""}}},{key:"events",get:function(){return{"click [data-audio-selector-select]":"onTrackSelect","click [data-audio-selector-button]":"onButtonClick"}}}],[{key:"version",get:function(){return VERSION}}]),e}(u.UICorePlugin);e.default=h,t.exports=e.default},/*!******************************************************************************************!*\
  !*** external {"amd":"clappr","commonjs":"clappr","commonjs2":"clappr","root":"Clappr"} ***!
  \******************************************************************************************/
function(e,n){e.exports=t},/*!****************************************!*\
  !*** ./src/public/level-selector.html ***!
  \****************************************/
function(t,e){t.exports='<button data-audio-selector-button></button>\n<ul>\n\n  <% for (var i = 0; i < tracks.length; i++) { %>    \n    <% var track = tracks[i]; %>\n    \n    <% if (track && track.name) { %>  \n      <% langList.push(lang); %>\n      <li>\n        <a href="#" data-audio-selector-select="<%= i %>">\n          <%= track.name %>\n        </a>\n      </li>  \n    <% }; %>\n    \n  <% }; %>\n\n</ul>\n'},/*!*******************************!*\
  !*** ./src/public/style.scss ***!
  \*******************************/
function(t,e,n){e=t.exports=n(/*! ../../~/css-loader/lib/css-base.js */5)(),e.push([t.id,".audio_selector[data-audio-selector]{float:right;margin-top:5px;position:relative}.audio_selector[data-audio-selector] button{outline:none;background-color:transparent;color:#fff;font-family:Roboto,Open Sans,Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:11px}.audio_selector[data-audio-selector] button:hover{color:#c9c9c9}.audio_selector[data-audio-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.audio_selector[data-audio-selector]>ul{list-style-type:none;position:absolute;bottom:35px;border:1px solid #000;display:none;background-color:rgba(0,0,0,.9)}.audio_selector[data-audio-selector] li{padding:1px;font-size:11px}.audio_selector[data-audio-selector] li[data-title]{background-color:#c3c2c2;padding:5px}.audio_selector[data-audio-selector] li a{color:#666;padding:3px 15px;display:block;text-decoration:none;white-space:nowrap}.audio_selector[data-audio-selector] li a:hover{background-color:#555;color:#fff}.audio_selector[data-audio-selector] li a:hover a{color:#fff;text-decoration:none}.audio_selector[data-audio-selector] li.current a{color:#fff}",""])},/*!**************************************!*\
  !*** ./~/css-loader/lib/css-base.js ***!
  \**************************************/
function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}}])});
//# sourceMappingURL=audio-selector.min.js.map